% !TEX TS-program = xelatex
% !TEX encoding = UTF-8 Unicode

% This is a simple template for a LaTeX document using the "article" class.
% See "book", "report", "letter" for other types of document.

\documentclass[12pt]{article} % use larger type; default would be 10pt

\usepackage[utf8]{inputenc} % set input encoding (not needed with XeLaTeX)

%%% Examples of Article customizations
% These packages are optional, depending whether you want the features they provide.
% See the LaTeX Companion or other references for full information.

%%% PAGE DIMENSIONS
\usepackage{geometry} % to change the page dimensions
\geometry{a4paper} % or letterpaper (US) or a5paper or....
% \geometry{margin=2in} % for example, change the margins to 2 inches all round
% \geometry{landscape} % set up the page for landscape
%   read geometry.pdf for detailed page layout information

\usepackage{graphicx} % support the \includegraphics command and options

\usepackage[parfill]{parskip} % Activate to begin paragraphs with an empty line rather than an indent

%%% PACKAGES
\usepackage{booktabs} % for much better looking tables
\usepackage{array} % for better arrays (eg matrices) in maths
\usepackage{paralist} % very flexible & customisable lists (eg. enumerate/itemize, etc.)
\usepackage{verbatim} % adds environment for commenting out blocks of text & for better verbatim
\usepackage{subfigure} % make it possible to include more than one captioned figure/table in a single float
% These packages are all incorporated in the memoir class to one degree or another...

% \usepackage{setspace}
% \linespread{1.5}

\renewcommand{\baselinestretch}{1.2}

\usepackage{xeCJK}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{float}
\usepackage{hyperref}
\usepackage{amsmath, amssymb}
\usepackage[linesnumbered,ruled]{algorithm2e}
\renewcommand{\figurename}{图}
\renewcommand{\abstractname}{摘要}
\renewcommand{\refname}{参考文献}
\hypersetup{colorlinks}

%%% HEADERS & FOOTERS
\usepackage{fancyhdr} % This should be set AFTER setting up the page geometry
\pagestyle{fancy} % options: empty , plain , fancy
\renewcommand{\headrulewidth}{0pt} % customise the layout...
\lhead{}\chead{}\rhead{}
\lfoot{}\cfoot{\thepage}\rfoot{}

%%% SECTION TITLE APPEARANCE
\usepackage{sectsty}
\allsectionsfont{\sffamily\mdseries\upshape} % (See the fntguide.pdf for font help)
% (This matches ConTeXt defaults)

%%% ToC (table of contents) APPEARANCE
\usepackage[nottoc,notlof,notlot]{tocbibind} % Put the bibliography in the ToC
\usepackage[titles,subfigure]{tocloft} % Alter the style of the Table of Contents
\renewcommand{\cftsecfont}{\rmfamily\mdseries\upshape}
\renewcommand{\cftsecpagefont}{\rmfamily\mdseries\upshape} % No bold!

%%% END Article customizations

%%% The "real" document content comes below...

\title{网络安全协议大作业}
\author{胡冬寅 \and 李锭轩 \and 林静雯}
\date{} % Activate to display a given date or no date (IF empty),
         % otherwise the current date is printed

\begin{document}
\maketitle

\section{导言}

\section{主体}
\label{main}

\subsection{应用层}
\label{app}

\subsubsection{针对协议的}
\label{protocol}

\textbf{DGA}

（*这里需要进一步介绍DGA的原理吗？需要介绍DNS攻击吗*）

Manos针对基于DGA的DNS攻击，提出了根据NXDomian流量来检测恶意域名的方法。

目前，面对僵尸网络这种DNS攻击，最常见的办法是为恶意域名建立黑名单，从而过滤掉对恶意域名的查询。但攻击者利用DGA（域名生成算法）可以由一个种子制造出大量域名，使得黑名单的响应速度远远跟不上恶意域名出现的速度。人们为了应对这种攻击所使用的逆向工程方法，效果并不理想。

因此本文作者提出了根据NXDomian流量来检测恶意域名的方法。NXDomian是在用户所查询的域名无法解析时服务器产生的响应。由DGA的原理，由一个种子所产生的大量域名，只会有一小部分被注册到恶意服务器的IP地址，因此被感染的僵尸主机在查询由DGA产生的域名时必然会产生大量NXDomian流量。这个方法之所以可行，是因为由同一个DGA，同一个种子所产生的一系列域名，会有各种相同的特征。这也就是说，只要分析出由同一种子生成的NXDomain的特征，就可以利用这些特征去检测由这个种子生成的，真正被注册到恶意DNS服务器的域名了。利用这一点，作者提出了如下检测模型

\begin{figure}
	\caption{Pleiades系统示意图}
	\label{dga_pic}
	\includegraphics[width = \linewidth]{./pics/dga}
\end{figure}

此模型被部署在本地的DNS服务器。在这里，它首先会收集NXDomian流量，对这些域名送到模型中的 NXDomain Clustering 进行特征提取分析，若遇到了特征相似的一系列域名，则将它们聚合起来，并在 DGA Modeling 中与已知DGA作比较，若吻合，则将它们归类到那一种DGA中；若不吻合，则利用将这一类特征归为新的DGA，并对其建模、存储在 new DGA model 中，留待与之后收集到的域名作比较。当完成这样的工作后，由某个DGA所产生的恶意域名会大概率被检测到与某一个DGA的特征相吻合，从而可以将它列入黑名单中。

值得一提的是，NXDomian的产生并不一定是恶意的，它可能是由于用户DNS服务器配置错误，或者手误产生，如果检测提取了这种流量的特征显然是不合理的。为了避免这种情况，作者在模型中加入了一个过滤器，它可以检测出这类NXDomain，并将其过滤，利用的方法是检测域名与一些合法周知域名的相似度，若相似，则说明这类NXDomain大概率是人为失误造成，应该将其过滤。

\textbf{HTTPS}

Zhang等提出了良性软件和恶意软件具有不同的HTTP错误生成模式以及HTTP错误的恢复策略模式的见解，并以此作为依据设计了新的系统Error-Sensor，该系统可以仅从HTTP错误以及其附近的成功请求检测恶意软件流量。该文章主要关注的是4xx类状态码指示的HTTP错误，该类状态码用于指示的是由于客户端而导致的错误的情况。恶意软件的活动而生成的HTTP错误大多属于该类别：网络扫描攻击可能会因扫描不存在的目标404 Not Found错误，或者由于扫描受保护路径中的网页而导致403 Forbidden错误，策略违规的请求也会导致403 Forbidden错误。但是并非发生HTTP错误就意味着该HTTP发起者为恶意软件，但是基于大量的现实数据，Zhang等观察到良性用户和恶意用户所生成的HTTP错误模式以及其恢复模式存在差异，该差异具体表现为，具体的表现为：受恶意软件影响的客户端通常会产生比良性客户端更多的HTTP错误，并且大多数错误都与恶意软件活动有关。并且，恶意软件生成的错误与良性用户/软件生成的错误具有显着不同的错误生成模式和恢复行为模式。存在这些不同的模式是因为良好的客户端在HTTP错误面前经常缺乏恢复例程。Error-Sensor检测系统就是基于这些差异来进行检测恶意软件的。在进行流量过滤以及根据客户端，服务器，网页和错误代码四元组进行错误聚类后，将错误聚类的流量进行分析，生成了错误源模式、错误生成模式、错误恢复模式这三大类特征指标，作为随机森林分类器的输入。具体来说，错误源模式包括了客户端声誉、服务端声誉、意外错误率等特征，错误生成模式包括错误生成顺序、频率等特征，错误恢复模式包括时间相关性、URI路径关联等。该系统在0.005\%的FPR水平下达到了99.79\%的检测率。要注意的是，该系统时DNS入侵系统的补充，因为http是在域名得到解析的前提下进行的，也就是该系统在DNS入侵系统检测失败后的进一步检测。

\subsubsection{针对内容的}
\label{content}

\textbf{广告}

Sajjad Arshad提出了一种通过细粒度的Web内容来源标识来检测基于扩展的广告注入的方法。

浏览器扩展很好地丰富了Web浏览器的功能，这为用户提供了很大的便利。但由于扩展程序一般拥有较高的权限，因此它也为攻击者提供了一个很好的平台，其中一种威胁就是基于扩展的广告注入。这种广告注入不仅可以通过播放广告来为注入者产生收益，它甚至还能使得网页发布者的合法收入转向第三方；另一方面，它可能会让用户看到不想看的内容，而用户通常不能分清这是来自第三方注入还是来自网页发布者，这给网页发布者造成了口碑上的负面影响。

为此，作者提出了\textit{ORIGINTRACER},这是一种可以集成到浏览器中的插件，它可以在DOM（文档对象模型）的粒度上标识网页元素的来源。它实现的原理是利用 \textit{起源标签集} 为网页中的DOM元素做注释，因为网页无论是在从发布者的服务器加载时，在按照脚本执行时，还是进行扩展时，浏览器总是可以知道添加或是修改DOM元素的主体是什么，这时候\textit{ORIGINTRACER} 就可以将这些主体添加到起源标签集中，以标识DOM元素的来源。

在分清DOM元素的来源后，\textit{ORIGINTRACER} 的做法是将注入的DOM元素通过高亮或是其他一些易于发现的标识的形式展现给用户。这样做的原因是第三方往往很难判断一个并非完全恶意的注入对用户来说是否受欢迎，有时候即时是广告注入，它也是为某些用户所需要的。因此\textit{ORIGINTRACER} 对它们进行检测后的目标并非过滤，而是清晰地标识并展示给用户，以帮助用户做出最有利于他们的选择。

\textbf{email}

Hugo（2018）提出了一种基于发送者的邮件结构和设置信息，使用传统机器学习模型的鱼叉式钓鱼邮件检测方法。该方法学习大量与具体文本无关的发送者的特征，并将其特征与其声称的来源的特征有偏差的邮件识别为欺骗性电子邮件。鱼叉式钓鱼邮件攻击是指针对特定目标，根据其相关信息构造带有恶意链接或附件的邮件攻击，使被攻击目标无法区分该邮件的真实来源和其所声称的来源，由于不同的鱼叉式钓鱼邮件攻击相差甚远，故很难被统一抵御。在实际场景中，攻击者对其假冒的发送者的了解是有限的，而这种已知信息的有限性造成的模仿的差异性是该检测方法的关键，结果表明，攻击者对其假冒的发送者越了解，其检测性能越低。值得一提的是，该文章将发送者的信息提取为与具体文本无关的三类特征，分别是行为特征、组成特征以及传输特征。行为特征是指发送者的习惯等特征，例如是否使用数字签名，附件类型和顺序等等。组成特征则是指客户端机器配置信息，例如公共头标的类型，顺序和语法。传输特征则与邮件传输路径有关，包括Received头标和顺序，以及Received头标中提供的传递协议和TLS功能。从结果可以看到，采用这些特征学习出来的不同发送者之间具有比较高的特异性（根据曼哈顿距离），说明了该特征提取是较为成功的。并且可以看到，传输特征在这三类特征中具有最大的辨别力，而由于其涉及基础硬件设施，也最难被伪造，所以该方法在具有特异性的鱼叉式钓鱼攻击检测中是有效的。另外值得一提的是，该文章采取了KNN和SVM模型，其优势在于其所需的样本量远远少于深度学习所需要的样本量。其中KNN最少只需要2个样本，SVM为5个。这十分符合该论文所研究的特定攻击的场景。在这种特定攻击中，数据量是有限的，具体来说，来自于同一发送者的信件的量不大，故采取KNN和SVM模型适合的，特别的，SVM分类器在少量可用的电子邮件中提供了更好的性能。

\subsection{网络层及传输层}
\label{ip}

\subsubsection{使用ML方法的}
\label{ml}

\textbf{TLS certificate}

I. Torroledo等人(2018)实现了第一个利用TLS协议的钓鱼攻击检测。由于TLS协议中数据报被加密，因此难以利用数据信息进行检测。该方法利用TLS协议中的证书信息进行钓鱼攻击检测，作者依据其所在单位多年的经验总结了35个与TLS证书相关的特征，使用单热编码方案对特征进行编码，编码后的向量输入神经网络进行学习。

神经网络由三部分并行构成，两部分是LSTM网络，另一部分是简单的ReLu激活函数。

该方法实现了94.87\%的恶意软件精确率，88.64\%的钓鱼网站精确率。该方法的不足之处是对于钓鱼网站的检测率较低，这是由于钓鱼网站的证书会与伪装得真实的证书十分相近。

\textbf{只使用了报头}

Navaporn实现了在不需要人工指定规则的前提下，使用深度学习算法检测网络攻击的方法。该方法只使用了报头的相关信息，并不涉及到载荷，以此保护数据隐私。在数据预处理中，先将通过tcpdump命令获得的pcap格式流量，并删除了数据包的有效负载。然后将包数据转换为流数据。流数据不同于包数据。通常，流数据会包含多个包的信息，而这些包共享一个流数据的标签。流数据是其覆盖的某个通信下的数据包的统计量和基础信息的总结，网络流的元数据包括IP地址，持续状态，历史状态以及包速度，字节速度供16个特征等等。在该文章的方法中，使用网络流的16个元数据作为特征供神经网络训练。为了检测和对攻击方式进行分类，该文章使用了RNN, Staked RNN, CNN神经网络进行训练，并检测了Dos攻击， 端口扫描，使用UDP发网络扫描，使用TCP的网络扫描，以及使用ICMP的网络扫描这五种攻击，并实现了对这些攻击的分类。同时，为了进行比较，将同样的数据包放到Snort系统中检测。Snort是一个基于规则的入侵检测系统，但是其使用载荷信息进行分析，并且计算的时间很长。测试结果表明，该方案优于基于规则的Snort入侵检测系统。

\subsubsection{使用非ML方法的}
\label{nonml}

\textbf{Entropy-score}

Akshat Gaurav等人(2017)提出了一种基于熵和评分机制的层次性DDoS攻击检测方法。该方法基于这样一个观察:在DDoS攻击期间，服务器接收到的包中源IP地址的熵值会比平常要高。该方法同时解决了如何将DDoS攻击与特定时段用户的大量访问进行区分的问题。

接收到的数据包会按照预先设置好的一些中心值进行分组，分组的依据是到源IP该值的距离。熵由各组的经验概率计算；分数由当前该组的概率与历史记录中的概率相除得到。如果最近一段时间内源IP的熵大于阈值，那说明系统目前可能遭遇DDoS攻击，但也有可能是用户的正常访问；如果小于阈值，当前数据会被记录下来更新分数表。接着，计算各组的分数，如果分数高于阈值，说明发生了DDoS攻击，不然则是正常的用户访问。

该方法综合了利用熵和计分方法的优势，做到了较低的虚警率。遗憾的是作者没有提及检测的精确率，也没有提及对于DDoS攻击和大量用户访问之间区分性有多好。但这种分析的方法在一众机器学习方法之中令人耳目一新。

\textbf{Traceroute-based}

K. Sakuma等人(2017)介绍了一种应对新型DDoS攻击——目标链路泛洪攻击(Target link flooding attack)的方法。该方法利用traceroute进行检测。目标链路泛洪攻击不直接针对目标区域发起DDoS攻击，而是对互联网中特定的链路进行攻击，从而将目标区域与其他区域隔离。

该方法的提出考虑到为实现这种攻击，攻击者需要对目标区域附近的网络拓扑结构进行探测。这就需要攻击者发送大量traceroute包，且这些包会集中在距离目标服务器若干跳的范围内。因此通过分析traceroute及其距离目标服务器的跳数即可对该类型DDoS攻击进行探测。

首先，距离目标服务器一定范围内会部署一定量的监控器，对traceroute进行记录，并将包按照距离目标服务器的跳数进行分类；总分析服务器收集各个分散的监控器的信息，计算分数。如果两个相邻时刻的分数相差超过阈值，那么就会发出攻击警报。

这种按跳数进行恩类的思想是这篇文章的亮点所在。它克服了只利用traceroute数量变化的方法的缺点，更加健壮。但是需要部署额外的探测器是一个问题，作者没有在文章中介绍探测器数目以及部署的策略对该方法的影响。

\textbf{Automated Attack Discovery in TCP Congestion}

Samuel Jero等人(2018)提出了一种基于有限状态机的TCP拥塞攻击发现方法。该方法受基于模型的测试(MBT)和模糊测试启发，利用TCP拥塞控制中的有限状态机作为模型指导模糊测试，从而发现新的攻击方式。

首先，该方法在有限状态机中寻找所有的可能攻击路线；然后将该路线转换成实际的攻击动作与数据包。这两部分别被称作抽象攻击策略与具体攻击策略。接着，作者在虚拟网络中进行了攻击测试，以判断该具体攻击策略是否确实显著地影响了网络流量。通过对可行的攻击策略进行分类，作者总结了11种TCP拥塞攻击，其中8种是目前文献中未被报道过的。

该方法的缺点在于，目前对于攻击的分析仍需通过日志文件由人工进行，即便可以在一定程度上自动化分析一部分，约11\%的攻击方案仍需要人工分析。

\subsection{数据链路层及物理层}
\label{phy}

\textbf{Cyber-Physical System Networks}

Peter Schneider等人(2018)提出了一个可对多种现场总线协议进行异常检测的实时、统一平台。该方法直接利用线路中的字节流数据进行异常检测，因此对多种上层协议有通用性。作者提出的检测方法是，将线路中的数据包按照定长进行划分，将每一个划分的字节流作为向量输入到层叠的去噪自动编码机中。其中，层叠指隐含层是多层的，去噪是指在训练时会对训练记得数据人工添加噪声，以避免过拟合。

自动编码机的架构包含编码机和解码机，训练时二者成对的被训练。损失函数定义为由解码机恢复的向量与原向量之间均方误差。对于正常的字节流，该编码机输出的向量与原始数据之间会有很小的均方误差；而对于异常数据，编码机的输出会有明显的误差。在给定阈值的情况下，只要是高于阈值的数据流都被判断为存在异常。

由于该方面免除了对包中协议内容的解析，其速度明显地由于需要解析信息的方法。同时，该方法可以解构成三个模块(数据获取、数据预处理以及数据分析)并行实现，因此具备了实时性的优势。

该方法实现了对较长攻击数据流的99\%检测率。不足之处是，对于较短的攻击数据流会漏检，这是来自于该方法对数据进行批处理。

\textbf{802.11}

Marc(2015)提出了用于检测协议感知的干扰攻击的异常入侵检测框架。该框架可被用于802.11网络。协议感知的干扰攻击是指针对于MAC或者网络层的控制信息发起的占用网络节点通信信道的拒绝服务攻击。该系统包含了两种方法。第一个方法是追踪关键包与非关键包的信噪比的统计信息。首先统计关键包和非关键包在一定时间段内的平均信噪比，并计算两者的比值。假设协议感知干扰存在，那么关键包的平均信噪比就会比较低，比值也会较低，故将比值低于一定阈值的场景判定为具有协议感知的干扰攻击的存在。第二个方法适用于信噪比无法测量的环境。类似地，统计关键包和非关键包在一定时间段内的丢包率，并计算比值，如果该比值远大于1，那么则判定是具有协议感知的干扰攻击存在。该框架适合于对数据包类型已知的系统，是属于物理层和MAC层或网络层进行结合的检测方法。该框架中所设计的信噪比计算以及阈值推导，运用了大量的通信知识，这是物理层检测的一大特点。

\textbf{802.11(另外一个)}

Eduard（2015）提出了一种运作于使用IEEE 802.11协议的局域网上的针对检测作弊行为和干扰攻击的方案。在IEEE 802.11中，干扰攻击可以防止节点执行合法的MAC操作，或者可以导致强制重复退避的帧的冲突，因此，在IEEE 802.11其他客户端的干扰信号期间总是监测到到介质忙，从而无法使用信道。而作弊行为或者欺骗性干扰试图修改MAC协议的约束以获得带宽增益，使得作弊节点可以快速访问媒体介质。该方案是利用BAT来检测作弊行为和干扰攻击。BAT被定义为从信标在TBTT时间点产生并被放到传输序列头部开始，一直到该信标真正被传输的时间。可以证明，当不存在作弊行为或者干扰攻击时，BAT是可以预测的。具体来说，将取决于与活动站相关的物理传输因子：站的数量，传输帧的大小，物理传输速率和提供的负载。当作弊行为和干扰攻击存在时，BAT明显大于AP的预测值，故可以通过BAT的偏离程度来判定是否存在作弊行为和干扰攻击。其依据为，具有作弊行为的设备可能会采取降低DIFS值以更快地获得共享信道的访问，或者减小退避时间选择的竞争窗口的值来更快地获得增大访问信道的概率。而这两个行为都会导致BAT的增加。对于干扰器，BAT值随着占用时间的增加而增加，随着静默时间的增加而减少。当占用时间比较大时，占用时间主导了对BAT的影响。这是无线网络中利用链路层协议检测攻击的方法。

\section{未来工作}
\label{future}

\subsection{数据}
\label{data}

在现在入侵检测的各个研究方向中，有很大一部分都涉及到了通过提取非法数据的特征来对他们进行识别。而在特征提取的时候，必不可少的是获得大量相关数据，根据检测的方法的不同，我们需要的可能是正常流量中的合法数据，或是异常流量中的非法数据。

在我们所阅读的论文中，作者们总是理所当然地获得了这些数据，从中提取了他们方法所需要的特征，并最终取得了很好的成果。但这些数据真的是这么容易获得吗？答案是否定的。就如上文中曾提到的DNS的分析为例，它需要大量的被动DNS数据集作为支撑，但这些数据集并不容易有效地收集，有些甚至是收到了法律限制的。若是没有充足而有效的数据集作为支撑，很大一部分理论上有效的方法，都会变成纸上谈兵，无法投入到实用中来。

因此，数据的收集是一个很好的未来研究方向。我们如何在法律允许的前提下，有效地收集各种数据，并形成一个开放的数据库供安全工作者们使用，这不仅为在研究新型方法的人们提供了便利，还使得已提出的各种方法投入到实际使用中提供了可能。

另一方面，受到了AGA（攻击生成算法）的启发，我们想到数据集除了收集之外，是否还可以通过一个算法来生成呢？如果我们可以写出一个算法，能够根据需要伪随机地生成特定类型的数据，那么相关研究的数据问题就可以得到根本性的解决了。当然，生成的数据是否符合实际，是否真的随机等问题肯定是存在的，这需要我们日后的研究来逐一解决。

这样的研究并非直接的涉及到入侵检测，但却是做好入侵检测所必不可少的铺垫性工作，是一个值得在未来研究的方向。

\subsection{面向连接型网络}
\label{connect}

目前网络传输中占据主导地位的是TCP/IP协议族，因此在讨论入侵检测时，一般来说也是基于TCP/IP协议来进行讨论的，部署检测系统或者方案时，也常常将目光放在端点处。

但随着网络节点的计算，存储能力的提升，之前不被广泛采用的ATM网络与MPLS网络变得有投入到实用中的可能。因此在未来，我们理应开始研究适应这两种网络的入侵检测系统，比如说我们可以很自然的将IDS部署在各个节点当中，并使得节点可以将它们检测到的信息进行相互交换、整合，从而获得比只在端点检测的系统更多，更全面的对网络状况的掌握。这样一来，攻击者产生的恶意流量会更加难以躲开安全系统的检测，甚至在到达客户端之前，就会在传输过程中被某个节点过滤。从安全工作者的角度来说，他们能使用的方案、策略会更加灵活多样。

另一方面，由于这种网络是面向连接的，通信双方都维护了连接的状态，这样一来IP网络中一个非常严重的问题：源地址的不确定性就得到了一定程度的解决。直接地，一些典型的与源地址修改相关的攻击的威胁会大大降低，例如IP地址欺骗、DRDOS攻击等等；间接地，在有了源地址可靠这么一个安全前提之后，我们就不需要将精力太多投入到源地址的确认上，这样自然可以提出一些新的更可靠的检测方案。


\subsection{各层之间}
\label{layer}

\textbf{1. 应用层IDS缺少统一性方案}

在本文涉及的文章中，面对DNS服务、HTTPS协议、浏览器插件广告插入以及电子邮件等，解决的方案都是特定的、针对性的。这是受应用层特性决定的:由于应用层希望为用户提供多种多样的服务，因此应用的数据格式高度分化，很难找到统一的监测方案。是否能找到一种通用性的解决方案为应用层提供更好的安全保障呢？

受到HTTPS下层的TLS协议启发，由于上层注定无法统一，因此从其下层进行处理是更好的策略。目前有许多流行的中间件，比如Google的QUIC协议，利用这些中间件为上层应用层服务提供更好的安全性是很有意义的研究方向。

是否可以设计一种能满足多种不同应用层需求的协议？它可以灵活的组装各种模块，就像IPSec中的IKE一样，可以为差异很大的不同应用提供服务；而它又可以有效地被IDS检测和分析。这种\textbf{中间件安全}引人思考。

\textbf{2. 针对数据链路层以及物理层的监测方案较少}

在寻找合适的文章过程中，一个现象是很少有针对数据链路层或物理层进行安全监测的方案。这样的检测是有益的，考虑到

\begin{enumerate}
    \item \textbf{应对信息受限情况}

    正如Peter Schneider等人这篇文章所述，在安全检测时，有时对上层协议不能获得完全的了解和知识，一个通用性的解决方案可以处理这样的问题；同时通用性也避免了重复开发的花费。

    \item \textbf{处理上层加密情况}

    TLS被越来越多的应用所使用；IPSec也可以对数据包进行保护；但是他们有共同的特点:数据内容被加密。这虽然为用户信息安全提供了一定的保障；但是也为攻击者提供了方便——加密的数据意味着许多方法不能被利用。而直接在数据链路层或物理层展开监测可以处理加密信息的安全监测。

    \item \textbf{对下层攻击的预防}

    在安全领域中，很常见的一种攻击方法是下层攻击。虽然本层的防御体系已经十分完善，但是对于来自下层的攻击还是力有不逮。如果，攻击者直接对电磁信号进行调整或伪造，或者在链路层中对帧进行修改，都可能会使上层的防御手段失效。
\end{enumerate}

但由于数据链路层以及物理层所包含的语义信息较少，各种检测方法有时难以实现较高的准确率。但这不代表这一层上不能够或不应该进行入侵检测。

\textbf{3. 各层之间的协作}

受到DPI启发，充分利用各个层之间的信息也对实现更好的入侵检测是很有帮助的。Peter Schneider等人(autoencoder)文章中所述，一些针对工业联网设备的攻击是控制逻辑上的攻击，也即其内容本身可能符合安全标准，但是多个包连续的组合会产生特定的攻击。这样的攻击，如果能通过最初对字节流的检测，然后更进一步对报文内容进行分析处理，相比可以更进一步提高准确性，并降低虚警率。

如果凭借本层信息不能完全确定，那么可以将本层的分析结果传送到上层的检测系统中，用于辅助进一步的分析。这样的协作模式可以对检测系统的提升有很大帮助。但是这同样会面里一个问题:开销的增长。面对越来越庞大的数据流，多层协作的IDS能否实时地对系统进行保护？这需要平衡协作的程度与开销，达到一个令人满意的程度。

\subsection{攻击}
\label{attack}

在入侵检测中我们所研究的各个类型的攻击中往往可以分为三类，它们是已知的攻击，未知的攻击，针对已有入侵检测系统的漏洞的改进型攻击。目前人们在研究中最成熟的自然是第一种，针对已知的攻击，我们可以针对性的提出各种各样来检测、防范，这样对于这一种特定攻击来说，检测效果一般会非常好。但良好的针对性往往牺牲的是通用性，在面对后面两种攻击的时候，这些检测方法的效果就会大打折扣。特别是最后一种，魔高一丈的入侵者在找准漏洞后所作出的改进后的攻击，将会在最大程度上削弱检测系统的效果。从这个角度上来说，后面这两种攻击会带来更大的安全威胁。

因此如何提出一种检测方法或者检测模型，使得它可以对可能出现的未知攻击具有很好的普适性是我们值得研究的方向。比如说，当它遇到未知的数据时，能否对它进行分析建模，并加入到一个可疑数据的库中，若日后发生了相应的安全问题，则可以据此数据库进行快速响应，避免危害的进一步扩大。

当然这只是一个粗糙的思路，并不一定经得起推敲。但这仍是一个值得我们在未来研究的方向，因为若是成功开发这样的方法，带来的安全保障将不是一些特定的检测方法所能比的。

\subsection{非概率方法}
\label{nonprob}

目前的入侵检测系统的检测方法主要有基于规则，和基于统计的。而随着人工智能的兴起，随着算力的大幅度提高，以传统机器学习和深度学习为代表的统计方法是目前研究的主流方向。基于规则的入侵检测系统的弱点在于其性能依赖于其系统中的规则数目，而规则越多，系统的处理时间越长，效率越低。但由于其无法识别未知攻击，漏检率高。而与基于规则的入侵检测系统不同，基于统计的方法可以检测未知攻击，但是会带来比较高的误报率。从理论上来看，漏检率和误报率是无法同时降低的，故如何在这两者之间进行折中处理，以符合实际的使用，是需要被关注的。在统计方法中，通常需要事先将大量的数据进行预处理，这些处理过程通常是基于规则的，故如何结合基于规则和基于统计的检测系统，并发挥各自的优势，也是值得探讨的。

通常，传统的机器学习需要大量的人工特征提取，而这有赖于人们的先验知识，虽然对比于深度学习，前期的准备工作量更大，但更有利于实现更精准的检测，也更适用于场合特定，且数据量不大的攻击检测。受此启发，由于网络中的数据主要是信息流，各种行为模式皆以信息的方式呈现，引入信息论的知识，也是未来的方向之一。信息论已被广泛地运用于检测Dos攻击的研究中，并表现出了比其他方法更低的误报率。如何将信息论更广泛的运用于其他的攻击检测，也是值得探讨的方向。

随着网络节点计算能力的增加，网络拓扑图的信息能够更好的被传递和储存，这使得图论可能成为未来入侵检测的重要方法。在计算能力大幅提升的背景下，将图论和统计结合也是一大未来的方向。

\begin{thebibliography}{99}

\bibitem{otsu} Otsu, N., "A Threshold Selection Method from Gray-Level Histograms." IEEE Transactions on Systems, Man, and Cybernetics. Vol. 9, No. 1, 1979, pp. 62–66.s

\end{thebibliography}

\end{document}
