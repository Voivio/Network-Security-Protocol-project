<https://link.springer.com/chapter/10.1007%2F978-3-030-00470-5_22>

We note that network failures caused by malware are quite different from the failures caused by benign users/software in terms of their failure patterns and recovery behavior patterns.

in light of 鉴于

大多数歹徒依靠恶意服务器来控制恶意软件（恶意软件）并从中获利。然而，当恶意服务器被防御者发现和阻止时，网络犯罪结构遭受单点故障问题。为了克服这些失败，网络犯罪分子开发了各种技术来逃避可能的检测并发起更多隐秘的恶意活动。例如，快速通量服务[ [30](https://link.springer.com/chapter/10.1007%2F978-3-030-00470-5_22#CR30) ]允许网络罪犯快速更改恶意域的IP地址，以避免基于IP的访问控制。域生成算法（DGA）[ [1](https://link.springer.com/chapter/10.1007%2F978-3-030-00470-5_22#CR1)，[33](https://link.springer.com/chapter/10.1007%2F978-3-030-00470-5_22#CR33)]允许网络罪犯动态生成域名以绕过基于域的阻止。网络犯罪分子还将大量合法的网络服务器作为“敲门石”或“重定向器”来妥协，以防止他们的恶意活动。

由网络犯罪分子和公司部署的高级检测系统部署的这种复杂的逃避技术的竞争导致企业网络中的两种服务器连接故障：DNS故障和HTTP错误。

We refer HTTP errors as HTTP connection failures whose response status codes are larger than 400, as defined by the HTTP standard [[2](https://link.springer.com/chapter/10.1007%2F978-3-030-00470-5_22#CR2)].

当恶意软件连接到已被管理员清除的受感染服务器（例如，导致HTTP 404 Not Found错误），或者被IDS或Web代理阻止的恶意服务器（例如，导致HTTP 403 Forbidden ）时，通常会发生HTTP错误错误）基于策略违规。

 Most of the errors are caused by connecting to benign servers with bad parameters, connecting to compromised servers that have already been cleaned, or scanning vulnerable webpages that have been removed/protected. 

HTTP错误：根据RFC 7231 [ [2](https://link.springer.com/chapter/10.1007%2F978-3-030-00470-5_22#CR2) ] 中HTTP响应状态代码的定义，4xx类状态代码用于指示客户端导致错误的情况。意软件活动生成的大多数错误都属于此类别。网络扫描攻击可能会因扫描不存在的易受攻击的目标网页而导致404 Not Found错误，或者由于扫描受保护路径中的网页而导致403 Forbidden错误。策略违规请求也会导致403 Forbidden错误。

客户端，服务器，网页和错误代码的组合来表示唯一的HTTP错误。

focus on the HTTP error traffic and their nearby successful request traffic

focus on the HTTP error traffic and their nearby successful request traffic

*揭示*用户/软件生成的错误与恶意软件生成的错误之间*的差异*。基于从分析中获得的见解，我们设计了一种新方法来*检测恶意软件生成的错误并提取恶意软件规避智能*。在这种情况下，智能意味着恶意软件在面对HTTP错误时使用的规避策略，例如连接到多个备用恶意服务器，受损服务器和其他良性服务器以进行Internet连接测试。

我们的方法补充了现有的DNS故障基于检测方法，】

---

主要观察：

**大多数良性错误都是由事故引起的。**当客户端从服务器收到错误时，如果客户端在观察时间窗口[2](https://link.springer.com/chapter/10.1007%2F978-3-030-00470-5_22#Fn2)期间至少与同一服务器建立了一个非错误连接，那么我们认为这样的错误是由错误生成的并将其定义为意外错误。

**恶意软件感染的客户端比良性客户端产生更多错误。**

**大多数良性错误都是由良性软件产生的。** *User-Agent*是HTTP标头中的字段，用于指示谁发起请求。我们会检查每个错误的User-Agent。

**恶意软件产生的错误与良性软件产生的错误有不同的生成模式**

**恶意软件比良性软件具有更多的恢复行为**

总结：受恶意软件影响的客户端通常会产生比良性客户端更多的HTTP错误，并且大多数错误都与恶意软件活动有关。根据我们的观察，恶意软件生成的错误与良性用户/软件生成的错误具有显着不同的错误生成模式和恢复行为模式。存在这些不同的模式是因为良好的客户端在HTTP错误面前经常缺乏恢复例程。

---

系统概述：

建立一个名为Error-Sensor的新型检测系统，旨在通过检查HTTP错误来检测恶意软件行为。

恶意软件行为可包括对良性服务器的HTTP攻击（例如，扫描易受攻击的页面），与恶意服务器（例如，C＆C服务器和受损服务器）的通信，以及其他良性行为（例如，测试网络连接）。

本文focus on malware traffic related to HTTP errors

过滤：

we filter out all the successful request traffic except for the successful requests within the time window TwTw of error traffic. 

define noisy errors as the errors generated by the clients who generate only a single error during the entire observation window[3](https://link.springer.com/chapter/10.1007%2F978-3-030-00470-5_22#Fn3) since it is difficult to acquire useful information from them. 

filter noisy errors too

聚类：

Given the filtered error traffic, the next step is to cluster them into groups.

Since we rely on the recovery behaviors generated by the same client, we group the errors by each client rather than across different clients.

 Error-Sensor is capable of detecting malware traffic even when there is only a single infected client.

分类：

RFC：随机森林分类器。

 Error-Sensor takes the clusters of errors and their surrounding successful HTTP requests as an input, and produces a verdict on whether the clusters are malicious or not.

**错误源模式（** EPP **）**

**错误生成模式（** EGP **）**

**错误恢复模式（** ERP **）**

