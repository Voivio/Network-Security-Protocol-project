## DGA

（*这里需要进一步介绍DGA的原理吗？需要介绍DNS攻击吗*）

Manos针对基于DGA的DNS攻击，提出了根据NXDomian流量来检测恶意域名的方法。

目前，面对僵尸网络这种DNS攻击，最常见的办法是为恶意域名建立黑名单，从而过滤掉对恶意域名的查询。但攻击者利用DGA（域名生成算法）可以由一个种子制造出大量域名，使得黑名单的响应速度远远跟不上恶意域名出现的速度。人们为了应对这种攻击所使用的逆向工程方法，效果并不理想。

因此本文作者提出了根据NXDomian流量来检测恶意域名的方法。NXDomian是在用户所查询的域名无法解析时服务器产生的响应。由DGA的原理，由一个种子所产生的大量域名，只会有一小部分被注册到恶意服务器的IP地址，因此被感染的僵尸主机在查询由DGA产生的域名时必然会产生大量NXDomian流量。这个方法之所以可行，是因为由同一个DGA，同一个种子所产生的一系列域名，会有各种相同的特征。这也就是说，只要分析出由同一种子生成的NXDomain的特征，就可以利用这些特征去检测由这个种子生成的，真正被注册到恶意DNS服务器的域名了。利用这一点，作者提出了如下检测模型

![](C:\Users\59191\Desktop\网络安全协议大作业\DGA检测系统结构.png)

此模型被部署在本地的DNS服务器。在这里，它首先会收集NXDomian流量，对这些域名进行特征提取并分析。若遇到了特征相似的一系列域名，则将它们聚合起来，并与已知DGA作比较，若吻合，则将它们归类到那一种DGA中；若不吻合，则将这一类特征归为新的DGA，并对其建模、存储，留待与之后收集到的域名作比较。当完成这样的工作后，由某个DGA所产生的恶意域名会大概率被检测到与某一个DGA的特征相吻合，从而可以将它列入黑名单中。

值得一提的是，NXDomian的产生并不一定是恶意的，它可能是由于用户DNS服务器配置错误，或者手误产生，如果检测提取了这种流量的特征显然是不合理的。为了避免这种情况，作者在模型中加入了一个过滤器，它可以检测出这类NXDomain，并将其过滤，利用的方法是检测域名与一些合法周知域名的相似度，若相似，则说明这类NXDomain大概率是人为失误造成，应该将其过滤。



## 广告注入

Sajjad Arshad提出了一种通过细粒度的Web内容来源标识来检测基于扩展的广告注入的方法。

浏览器扩展很好地丰富了Web浏览器的功能，这为用户提供了很大的便利。但由于扩展程序一般拥有较高的权限，因此它也为攻击者提供了一个很好的平台，其中一种威胁就是基于扩展的广告注入。这种广告注入不仅可以通过播放广告来为注入者产生收益，它甚至还能使得网页发布者的合法收入转向第三方；另一方面，它可能会让用户看到不想看的内容，而用户通常不能分清这是来自第三方注入还是来自网页发布者，这给网页发布者造成了口碑上的负面影响。

为此，作者提出了*ORIGINTRACER*,这是一种可以集成到浏览器中的插件，它可以在DOM（文档对象模型）的粒度上标识网页元素的来源。它实现的原理是利用 *起源标签集* 为网页中的DOM元素做注释，因为网页无论是在从发布者的服务器加载时，在按照脚本执行时，还是进行扩展时，浏览器总是可以知道添加或是修改DOM元素的主体是什么，这时候*ORIGINTRACER* 就可以将这些主体添加到起源标签集中，以标识DOM元素的来源。

在分清DOM元素的来源后，*ORIGINTRACER* 的做法是将注入的DOM元素通过高亮或是其他一些易于发现的标识的形式展现给用户。这样做的原因是第三方往往很难判断一个并非完全恶意的注入对用户来说是否受欢迎，有时候即时是广告注入，它也是为某些用户所需要的。因此*ORIGINTRACER* 对它们进行检测后的目标并非过滤，而是清晰地标识并展示给用户，以帮助用户做出最有利于他们的选择。



## Future Work

### 1.Data

在现在入侵检测的各个研究方向中，有很大一部分都涉及到了通过提取非法数据的特征来对他们进行识别。而在特征提取的时候，必不可少的是获得大量相关数据，根据检测的方法的不同，我们需要的可能是正常流量中的合法数据，或是异常流量中的非法数据。

在我们所阅读的论文中，作者们总是理所当然地获得了这些数据，从中提取了他们方法所需要的特征，并最终取得了很好的成果。但这些数据真的是这么容易获得吗？答案是否定的。就如上文中曾提到的DNS的分析为例，它需要大量的被动DNS数据集作为支撑，但这些数据集并不容易有效地收集，有些甚至是收到了法律限制的。若是没有充足而有效的数据集作为支撑，很大一部分理论上有效的方法，都会变成纸上谈兵，无法投入到实用中来。

因此，数据的收集是一个很好的未来研究方向。我们如何在法律允许的前提下，有效地收集各种数据，并形成一个开放的数据库供安全工作者们使用，这不仅为在研究新型方法的人们提供了便利，还使得已提出的各种方法投入到实际使用中提供了可能。

另一方面，受到了AGA（攻击生成算法）的启发，我们想到数据集除了收集之外，是否还可以通过一个算法来生成呢？如果我们可以写出一个算法，能够根据需要伪随机地生成特定类型的数据，那么相关研究的数据问题就可以得到根本性的解决了。当然，生成的数据是否符合实际，是否真的随机等问题肯定是存在的，这需要我们日后的研究来逐一解决。

这样的研究并非直接的涉及到入侵检测，但却是做好入侵检测所必不可少的铺垫性工作，是一个值得在未来研究的方向。



### 2.ATM / MPLS

目前网络传输中占据主导地位的是TCP/IP协议族，因此在讨论入侵检测时，一般来说也是基于TCP/IP协议来进行讨论的，部署检测系统或者方案时，也常常将目光放在端点处。

但随着网络节点的计算，存储能力的提升，之前不被广泛采用的ATM网络与MPLS网络变得有投入到实用中的可能。因此在未来，我们理应开始研究适应这两种网络的入侵检测系统，比如说我们可以很自然的将IDS部署在各个节点当中，并使得节点可以将它们检测到的信息进行相互交换、整合，从而获得比只在端点检测的系统更多，更全面的对网络状况的掌握。这样一来，攻击者产生的恶意流量会更加难以躲开安全系统的检测，甚至在到达客户端之前，就会在传输过程中被某个节点过滤。从安全工作者的角度来说，他们能使用的方案、策略会更加灵活多样。

另一方面，由于这种网络是面向连接的，通信双方都维护了连接的状态，这样一来IP网络中一个非常严重的问题：源地址的不确定性就得到了一定程度的解决。直接地，一些典型的与源地址修改相关的攻击的威胁会大大降低，例如IP地址欺骗、DRDOS攻击等等；间接地，在有了源地址可靠这么一个安全前提之后，我们就不需要将精力太多投入到源地址的确认上，这样自然可以提出一些新的更可靠的检测方案。



### 4. 3 Attack

在入侵检测中我们所研究的各个类型的攻击中往往可以分为三类，它们是已知的攻击，未知的攻击，针对已有入侵检测系统的漏洞的改进型攻击。目前人们在研究中最成熟的自然是第一种，针对已知的攻击，我们可以针对性的提出各种各样来检测、防范，这样对于这一种特定攻击来说，检测效果一般会非常好。但良好的针对性往往牺牲的是通用性，在面对后面两种攻击的时候，这些检测方法的效果就会大打折扣。特别是最后一种，魔高一丈的入侵者在找准漏洞后所作出的改进后的攻击，将会在最大程度上削弱检测系统的效果。从这个角度上来说，后面这两种攻击会带来更大的安全威胁。

因此如何提出一种检测方法或者检测模型，使得它可以对可能出现的未知攻击具有很好的普适性是我们值得研究的方向。比如说，当它遇到未知的数据时，能否对它进行分析建模，并加入到一个可疑数据的库中，若日后发生了相应的安全问题，则可以据此数据库进行快速响应，避免危害的进一步扩大。

当然这只是一个粗糙的思路，并不一定经得起推敲。但这仍是一个值得我们在未来研究的方向，因为若是成功开发这样的方法，带来的安全保障将不是一些特定的检测方法所能比的。















